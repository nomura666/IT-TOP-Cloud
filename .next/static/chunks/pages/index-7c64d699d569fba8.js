(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(9828)}])},9828:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var r=s(5893),a=s(1163),n=s(7294);function l(){let e=(0,a.useRouter)(),[t,s]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[o,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(!1),[h,j]=(0,n.useState)(!1),[p,f]=(0,n.useState)(""),[x,m]=(0,n.useState)(!1),[k,v]=(0,n.useState)(!0);if((0,n.useEffect)(()=>{let e=localStorage.getItem("userName");e&&f(e)},[]),(0,n.useEffect)(()=>{(async function(){try{(await fetch("/api/auth/authenticate",{method:"GET",credentials:"include"})).ok?j(!0):v(!1)}catch(e){console.error("Auth check error:",e),v(!1)}})()},[e]),(0,n.useEffect)(()=>{if(h){let t=setTimeout(()=>{m(!0)},2e3),s=setTimeout(()=>{e.push("/dashboard")},3e3);return()=>{clearTimeout(t),clearTimeout(s)}}},[h,e]),null===k)return null;let w=async e=>{e.preventDefault(),c(null),d(!0);try{var s;let e=await fetch("/api/auth/authenticate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:t,password:l})}),r=await e.json();if(!e.ok)throw Error(r.error||"Ошибка авторизации");localStorage.setItem("authToken",r.token),f((null===(s=r.user)||void 0===s?void 0:s.name)||t),localStorage.setItem("userName",r.user.name),j(!0)}catch(e){c(e.message)}finally{d(!1)}};return(0,r.jsxs)("div",{className:"page-wrapper",children:[(0,r.jsxs)("div",{className:"logo-container ".concat(x?"fly-into":""),children:[(0,r.jsx)(()=>(0,r.jsxs)("svg",{width:"127",height:"89",viewBox:"0 0 127 89",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M65.3261 27.8818L60.3314 37.0869L56.0527 20.0216L126.1 1L65.3261 27.8818Z",fill:"#C1C1C1",stroke:"black","stroke-linejoin":"round"}),(0,r.jsx)("path",{d:"M71.2473 32.4757L60.3848 37.087L65.3794 27.8818L71.2473 32.4757Z",fill:"black",stroke:"black","stroke-linejoin":"round"}),(0,r.jsx)("path",{d:"M50.0795 8.37109L126.047 1L56.0521 20.0216L48.4204 14.537C45.8706 12.7029 46.9534 8.6855 50.0795 8.37109Z",fill:"white",stroke:"black","stroke-linejoin":"round"}),(0,r.jsx)("path",{d:"M126.049 1L65.3271 27.8818L79.6475 38.5716C82.5116 40.7026 86.5109 40.4231 89.0431 37.9079L126.049 1Z",fill:"white",stroke:"black","stroke-linejoin":"round"}),(0,r.jsx)("path",{d:"M60.2002 36.9102C49.023 36.9102 34.3057 47.0122 35.0432 56.69C35.371 60.9822 39.6158 63.5934 44.3194 62.402C49.023 61.2106 51.0388 57.2286 48.0396 53.883C44.0408 49.4113 33.7649 47.9588 21.3421 56.9022C10.9024 64.4094 3.62575 76.2414 1.2002 87.9102",stroke:"#1C1C1E","stroke-width":"1.34152","stroke-linecap":"round","stroke-linejoin":"round"})]}),{}),(0,r.jsx)("div",{className:"logo-text",children:"IT TOP | Cloud"})]}),(0,r.jsxs)("div",{className:"container ".concat(x?"slide-out-down":""),id:"container",children:[(0,r.jsx)("div",{className:"form-container",children:h?(0,r.jsxs)("div",{className:"welcome-box",children:[(0,r.jsxs)("h1",{children:["Добро пожаловать, ",p,"!"]}),(0,r.jsxs)("div",{className:"redirect-message",children:[(0,r.jsx)("p",{children:"Перенаправляем на панель..."}),(0,r.jsx)("div",{className:"loading-spinner"})]})]}):(0,r.jsxs)("form",{onSubmit:w,children:[(0,r.jsx)("h1",{children:"Вход"}),(0,r.jsx)("input",{type:"text",placeholder:"Логин",value:t,onChange:e=>s(e.target.value),required:!0}),(0,r.jsx)("input",{type:"password",placeholder:"Пароль",value:l,onChange:e=>i(e.target.value),required:!0}),o&&(0,r.jsx)("p",{className:"error-text",children:o}),(0,r.jsx)("button",{type:"submit",disabled:u,children:u?"Вход...":"Войти"})]})}),(0,r.jsx)("div",{className:"overlay-container",children:(0,r.jsx)("div",{className:"overlay",children:(0,r.jsxs)("div",{className:"overlay-panel",children:[(0,r.jsx)("h1",{children:"Добро пожаловать!"}),(0,r.jsxs)("p",{children:["Войдите, используя логин и пароль от\xa0",(0,r.jsx)("a",{href:"https://journal.top-academy.ru",target:"_blank",rel:"noreferrer",children:"Journal"})]})]})})})]})]})}},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);